---
title: "Final Code"
author: "Kate Davey, Emilio Lugo, Mike Ward"
date: '2022-05-01'
output: html_document
---
#Installing Packages
```{r include=FALSE}
source("https://raw.github.com/neilhatfield/STAT461/master/rScripts/checkSetup.R")
checkSetup()
packages <- c("tidyverse", "hasseDiagram", "knitr", "kableExtra", "car", "psych", "parameters", "dplyr") 
lapply(packages, library, character.only = TRUE)
options(knitr.kable.NA = "")
options(contrasts = c("contr.sum", "contr.poly"))
source("https://raw.github.com/neilhatfield/STAT461/master/rScripts/ANOVATools.R")

```

#factors
```{r}
GameData<-Data
GameData <- GameData %>%
  dplyr::mutate( 
    production = dplyr::recode_factor( 
      production, 
      "< 3 years" = "< 3 years",
      "3-5 years" = "3-5 years", 
      ">5 years" = "> 5 years", "> 5 years" = "> 5 years" 
    )
  )

GameData$genre <- as.factor(GameData$genre)
GameData$series <- as.factor(GameData$series)
GameData$exclusive <- as.factor(GameData$exclusive)
GameData$production <- as.factor(GameData$production)
GameData$post <- as.factor(GameData$post)
str(GameData)
```

#Visualizations
```{r}
ggplot( 
  data = GameData, 
  mapping = aes( 
    x = production, 
    y = copies, 
  ) 
) + 
  geom_boxplot() + 
  theme_bw() + 
  xlab("Production Time") + 
  ylab("Copies (in Millions)") + 
  theme( 
    legend.position = "right",
    text = element_text(size = 14,)
  )
```

#Descriptive Statistics

```{r}

GameStats <- psych::describeBy(
  x = GameData$copies, # Notice how we're getting the factorial treatments 
  group = paste(GameData$production, sep = " x "), 
  na.rm = TRUE, 
  skew = TRUE, 
  ranges = TRUE, 
  quant = c(0.25, 0.75),
  IQR = TRUE, 
  mat = TRUE, 
  digits = 4
)

GameStats %>% 
  tibble::remove_rownames() %>%
  tibble::column_to_rownames(
    var = "group1" 
  ) %>% 
  dplyr::select(
    n, min, Q0.25, median, Q0.75, max, mad, mean, sd, skew, kurtosis 
  ) %>% 
  knitr::kable(
    caption = "Summary Statistics for Game Data",
    digits = 3,
    format.args = list(big.mark = ","),
    align = rep('c', 11),
    col.names = c("n", "Min", "Q1", "Median", "Q3", "Max", "MAD", "SAM", "SASD", "Sample Skew","Sample Ex. Kurtosis"),
    booktabs = TRUE 
  ) %>% 
  kableExtra::kable_styling(
    font_size = 12,
    latex_options = c("HOLD_position", "scale_down") 
  )
```
# Base Interaction Plot
```{r}
interaction.plot(
  x.factor = GameData$production, # First Factor 
  trace.factor = GameData$post, # Second Factor
  response = GameData$copies, # Response fun = mean, 
  type = "b", # Both points and lines 
  col = c("black","red","blue"), # Set colors for trace 
  pch = c(19, 17, 15), # Set symbols for trace 
  fixed = TRUE, legend = TRUE, 
  xlab = "Production Time",
  ylab = "Copies Sold (in Millions)",
  trace.label = "Post Production")
```

#Create Model
```{r}

```

# Assess Assumptions
```{r}

```

